<!DOCTYPE html>
<html lang="he" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>בדיקת מחשבון צביעה</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
        direction: rtl;
      }
      .test-case {
        margin: 20px 0;
        padding: 15px;
        border: 1px solid #ccc;
        border-radius: 5px;
      }
      .result {
        font-weight: bold;
        color: #2c3e50;
      }
      .expected {
        color: #27ae60;
      }
      .actual {
        color: #e74c3c;
      }
    </style>
  </head>
  <body>
    <h1>בדיקת מחשבון מחירי צביעה</h1>
    <div id="test-results"></div>

    <script>
      // Copy the pricing constants from script.js
      const PRICING = {
        BASE_ROOM: 500,
        CEILING_PER_ROOM: 100,
        PLASTER_PER_ROOM: 100,
        SANDING_PER_ROOM: 250,
        LOCATION: {
          BASE_DISTANCE: 10,
          MEDIUM_DISTANCE: 30,
          MEDIUM_EXTRA: 50,
          PER_30KM: 70,
          MAX_DISTANCE: 200,
        },
      };

      const DISTANCE_FROM_BEIT_SHEAN = {
        "בית שאן": 0,
        נצרת: 25,
        טבריה: 35,
        "תל אביב-יפו": 90,
        ירושלים: 100,
      };

      function calculateLocationSurcharge(location) {
        if (!location) return 0;

        const distance = DISTANCE_FROM_BEIT_SHEAN[location];
        if (distance === undefined) return 0;

        if (distance <= PRICING.LOCATION.BASE_DISTANCE) {
          return 0;
        } else if (distance <= PRICING.LOCATION.MEDIUM_DISTANCE) {
          return PRICING.LOCATION.MEDIUM_EXTRA;
        } else {
          const extraDistance = distance - PRICING.LOCATION.MEDIUM_DISTANCE;
          const extraCharges = Math.ceil(extraDistance / 30);
          return (
            PRICING.LOCATION.MEDIUM_EXTRA +
            extraCharges * PRICING.LOCATION.PER_30KM
          );
        }
      }

      function calculatePrice(
        rooms,
        ceilingRooms,
        plasterRooms,
        sandingRooms,
        location
      ) {
        let totalPrice = rooms * PRICING.BASE_ROOM;
        totalPrice += ceilingRooms * PRICING.CEILING_PER_ROOM;
        totalPrice += plasterRooms * PRICING.PLASTER_PER_ROOM;
        totalPrice += sandingRooms * PRICING.SANDING_PER_ROOM;
        totalPrice += calculateLocationSurcharge(location);
        return totalPrice;
      }

      // Test cases
      const testCases = [
        {
          name: "חדר אחד בסיסי - בית שאן",
          rooms: 1,
          ceilingRooms: 0,
          plasterRooms: 0,
          sandingRooms: 0,
          location: "בית שאן",
          expected: 500,
        },
        {
          name: "חדר אחד עם תקרה - בית שאן",
          rooms: 1,
          ceilingRooms: 1,
          plasterRooms: 0,
          sandingRooms: 0,
          location: "בית שאן",
          expected: 600,
        },
        {
          name: "חדר אחד עם כל התוספות - בית שאן",
          rooms: 1,
          ceilingRooms: 1,
          plasterRooms: 1,
          sandingRooms: 1,
          location: "בית שאן",
          expected: 950,
        },
        {
          name: "3 חדרים בסיסיים - נצרת",
          rooms: 3,
          ceilingRooms: 0,
          plasterRooms: 0,
          sandingRooms: 0,
          location: "נצרת",
          expected: 1550, // 3*500 + 50 (location surcharge)
        },
        {
          name: "2 חדרים עם תקרה - טבריה",
          rooms: 2,
          ceilingRooms: 2,
          plasterRooms: 0,
          sandingRooms: 0,
          location: "טבריה",
          expected: 1250, // 2*500 + 2*100 + 50
        },
        {
          name: "חדר אחד עם כל התוספות - תל אביב",
          rooms: 1,
          ceilingRooms: 1,
          plasterRooms: 1,
          sandingRooms: 1,
          location: "תל אביב-יפו",
          expected: 1200, // 500 + 100 + 100 + 250 + 250 (location surcharge for 90km)
        },
      ];

      function runTests() {
        const resultsDiv = document.getElementById("test-results");
        let allPassed = true;

        testCases.forEach((testCase, index) => {
          const actual = calculatePrice(
            testCase.rooms,
            testCase.ceilingRooms,
            testCase.plasterRooms,
            testCase.sandingRooms,
            testCase.location
          );

          const passed = actual === testCase.expected;
          if (!passed) allPassed = false;

          const testDiv = document.createElement("div");
          testDiv.className = "test-case";
          testDiv.innerHTML = `
                    <h3>בדיקה ${index + 1}: ${testCase.name}</h3>
                    <p><strong>פרמטרים:</strong> ${
                      testCase.rooms
                    } חדרים, תקרה: ${testCase.ceilingRooms}, שפכטל: ${
            testCase.plasterRooms
          }, שיוף: ${testCase.sandingRooms}, מיקום: ${testCase.location}</p>
                    <p class="result ${passed ? "expected" : "actual"}">
                        ${passed ? "✅ עבר" : "❌ נכשל"}: 
                        צפוי: ₪${testCase.expected.toLocaleString()}, 
                        בפועל: ₪${actual.toLocaleString()}
                    </p>
                `;
          resultsDiv.appendChild(testDiv);
        });

        const summaryDiv = document.createElement("div");
        summaryDiv.className = "test-case";
        summaryDiv.style.backgroundColor = allPassed ? "#d4edda" : "#f8d7da";
        summaryDiv.style.borderColor = allPassed ? "#c3e6cb" : "#f5c6cb";
        summaryDiv.innerHTML = `
                <h2 style="color: ${allPassed ? "#155724" : "#721c24"}">
                    ${
                      allPassed
                        ? "✅ כל הבדיקות עברו בהצלחה!"
                        : "❌ חלק מהבדיקות נכשלו"
                    }
                </h2>
            `;
        resultsDiv.appendChild(summaryDiv);
      }

      // Run tests when page loads
      document.addEventListener("DOMContentLoaded", runTests);
    </script>
  </body>
</html>
